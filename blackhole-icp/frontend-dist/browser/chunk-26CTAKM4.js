import{d as Qt,e as U,f as Le,g as x,h as k,i as er,k as R}from"./chunk-HIVZEDT5.js";var Ae=U((On,Se)=>{"use strict";var F=typeof Reflect=="object"?Reflect:null,et=F&&typeof F.apply=="function"?F.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},ne;F&&typeof F.ownKeys=="function"?ne=F.ownKeys:Object.getOwnPropertySymbols?ne=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:ne=function(t){return Object.getOwnPropertyNames(t)};function tr(e){console&&console.warn&&console.warn(e)}var rt=Number.isNaN||function(t){return t!==t};function g(){g.init.call(this)}Se.exports=g;Se.exports.once=ir;g.EventEmitter=g;g.prototype._events=void 0;g.prototype._eventsCount=0;g.prototype._maxListeners=void 0;var tt=10;function oe(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return tt},set:function(e){if(typeof e!="number"||e<0||rt(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");tt=e}});g.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};g.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||rt(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function nt(e){return e._maxListeners===void 0?g.defaultMaxListeners:e._maxListeners}g.prototype.getMaxListeners=function(){return nt(this)};g.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var o=t==="error",i=this._events;if(i!==void 0)o=o&&i.error===void 0;else if(!o)return!1;if(o){var a;if(r.length>0&&(a=r[0]),a instanceof Error)throw a;var h=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw h.context=a,h}var c=i[t];if(c===void 0)return!1;if(typeof c=="function")et(c,this,r);else for(var u=c.length,p=ft(c,u),n=0;n<u;++n)et(p[n],this,r);return!0};function ot(e,t,r,n){var o,i,a;if(oe(r),i=e._events,i===void 0?(i=e._events=Object.create(null),e._eventsCount=0):(i.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),a=i[t]),a===void 0)a=i[t]=r,++e._eventsCount;else if(typeof a=="function"?a=i[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),o=nt(e),o>0&&a.length>o&&!a.warned){a.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=a.length,tr(h)}return e}g.prototype.addListener=function(t,r){return ot(this,t,r,!1)};g.prototype.on=g.prototype.addListener;g.prototype.prependListener=function(t,r){return ot(this,t,r,!0)};function rr(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function it(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=rr.bind(n);return o.listener=r,n.wrapFn=o,o}g.prototype.once=function(t,r){return oe(r),this.on(t,it(this,t,r)),this};g.prototype.prependOnceListener=function(t,r){return oe(r),this.prependListener(t,it(this,t,r)),this};g.prototype.removeListener=function(t,r){var n,o,i,a,h;if(oe(r),o=this._events,o===void 0)return this;if(n=o[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===r||n[a].listener===r){h=n[a].listener,i=a;break}if(i<0)return this;i===0?n.shift():nr(n,i),n.length===1&&(o[t]=n[0]),o.removeListener!==void 0&&this.emit("removeListener",t,h||r)}return this};g.prototype.off=g.prototype.removeListener;g.prototype.removeAllListeners=function(t){var r,n,o;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var i=Object.keys(n),a;for(o=0;o<i.length;++o)a=i[o],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(o=r.length-1;o>=0;o--)this.removeListener(t,r[o]);return this};function st(e,t,r){var n=e._events;if(n===void 0)return[];var o=n[t];return o===void 0?[]:typeof o=="function"?r?[o.listener||o]:[o]:r?or(o):ft(o,o.length)}g.prototype.listeners=function(t){return st(this,t,!0)};g.prototype.rawListeners=function(t){return st(this,t,!1)};g.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):at.call(e,t)};g.prototype.listenerCount=at;function at(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}g.prototype.eventNames=function(){return this._eventsCount>0?ne(this._events):[]};function ft(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function nr(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function or(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function ir(e,t){return new Promise(function(r,n){function o(a){e.removeListener(t,i),n(a)}function i(){typeof e.removeListener=="function"&&e.removeListener("error",o),r([].slice.call(arguments))}ct(e,t,i,{once:!0}),t!=="error"&&sr(e,o,{once:!0})})}function sr(e,t,r){typeof e.on=="function"&&ct(e,"error",t,r)}function ct(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function o(i){n.once&&e.removeEventListener(t,o),r(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}});var lt=U((xn,ut)=>{"use strict";function ar(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}ut.exports=fr;function fr(e,t,r){var n=r&&r.stringify||ar,o=1;if(typeof e=="object"&&e!==null){var i=t.length+o;if(i===1)return e;var a=new Array(i);a[0]=n(e);for(var h=1;h<i;h++)a[h]=n(t[h]);return a.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var u="",p=1-o,l=-1,b=e&&e.length||0,d=0;d<b;){if(e.charCodeAt(d)===37&&d+1<b){switch(l=l>-1?l:0,e.charCodeAt(d+1)){case 100:case 102:if(p>=c||t[p]==null)break;l<d&&(u+=e.slice(l,d)),u+=Number(t[p]),l=d+2,d++;break;case 105:if(p>=c||t[p]==null)break;l<d&&(u+=e.slice(l,d)),u+=Math.floor(Number(t[p])),l=d+2,d++;break;case 79:case 111:case 106:if(p>=c||t[p]===void 0)break;l<d&&(u+=e.slice(l,d));var w=typeof t[p];if(w==="string"){u+="'"+t[p]+"'",l=d+2,d++;break}if(w==="function"){u+=t[p].name||"<anonymous>",l=d+2,d++;break}u+=n(t[p]),l=d+2,d++;break;case 115:if(p>=c)break;l<d&&(u+=e.slice(l,d)),u+=String(t[p]),l=d+2,d++;break;case 37:l<d&&(u+=e.slice(l,d)),u+="%",l=d+2,d++,p--;break}++p}++d}return l===-1?e:(l<b&&(u+=e.slice(l)),u)}});var Ce=U((Rn,yt)=>{"use strict";var ht=lt();yt.exports=T;var $=mr().console||{},cr={mapHttpRequest:ie,mapHttpResponse:ie,wrapRequestSerializer:Te,wrapResponseSerializer:Te,wrapErrorSerializer:Te,req:ie,res:ie,err:pr};function ur(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function T(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||$;e.browser.write&&(e.browser.asObject=!0);let n=e.serializers||{},o=ur(e.browser.serialize,n),i=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);let a=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),e.enabled===!1&&(e.level="silent");let h=e.level||"info",c=Object.create(r);c.log||(c.log=G),Object.defineProperty(c,"levelVal",{get:p}),Object.defineProperty(c,"level",{get:l,set:b});let u={transmit:t,serialize:o,asObject:e.browser.asObject,levels:a,timestamp:yr(e)};c.levels=T.levels,c.level=h,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=G,c.serializers=n,c._serialize=o,c._stdErrSerialize=i,c.child=d,t&&(c._logEvent=Pe());function p(){return this.level==="silent"?1/0:this.levels.values[this.level]}function l(){return this._level}function b(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,J(u,c,"error","log"),J(u,c,"fatal","error"),J(u,c,"warn","error"),J(u,c,"info","log"),J(u,c,"debug","log"),J(u,c,"trace","log")}function d(w,C){if(!w)throw new Error("missing bindings for child Pino");C=C||{},o&&w.serializers&&(C.serializers=w.serializers);let ee=C.serializers;if(o&&ee){var z=Object.assign({},n,ee),q=e.browser.serialize===!0?Object.keys(z):o;delete w.serializers,se([w],q,z,this._stdErrSerialize)}function te(A){this._childLevel=(A._childLevel|0)+1,this.error=V(A,w,"error"),this.fatal=V(A,w,"fatal"),this.warn=V(A,w,"warn"),this.info=V(A,w,"info"),this.debug=V(A,w,"debug"),this.trace=V(A,w,"trace"),z&&(this.serializers=z,this._serialize=q),t&&(this._logEvent=Pe([].concat(A._logEvent.bindings,w)))}return te.prototype=this,new te(this)}return c}T.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};T.stdSerializers=cr;T.stdTimeFunctions=Object.assign({},{nullTime:dt,epochTime:pt,unixTime:vr,isoTime:gr});function J(e,t,r,n){let o=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?G:o[r]?o[r]:$[r]||$[n]||G,lr(e,t,r)}function lr(e,t,r){!e.transmit&&t[r]===G||(t[r]=function(n){return function(){let i=e.timestamp(),a=new Array(arguments.length),h=Object.getPrototypeOf&&Object.getPrototypeOf(this)===$?$:this;for(var c=0;c<a.length;c++)a[c]=arguments[c];if(e.serialize&&!e.asObject&&se(a,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(h,hr(this,r,a,i)):n.apply(h,a),e.transmit){let u=e.transmit.level||t.level,p=T.levels.values[u],l=T.levels.values[r];if(l<p)return;dr(this,{ts:i,methodLevel:r,methodValue:l,transmitLevel:u,transmitValue:T.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},a)}}}(t[r]))}function hr(e,t,r,n){e._serialize&&se(r,e._serialize,e.serializers,e._stdErrSerialize);let o=r.slice(),i=o[0],a={};n&&(a.time=n),a.level=T.levels.values[t];let h=(e._childLevel|0)+1;if(h<1&&(h=1),i!==null&&typeof i=="object"){for(;h--&&typeof o[0]=="object";)Object.assign(a,o.shift());i=o.length?ht(o.shift(),o):void 0}else typeof i=="string"&&(i=ht(o.shift(),o));return i!==void 0&&(a.msg=i),a}function se(e,t,r,n){for(let o in e)if(n&&e[o]instanceof Error)e[o]=T.stdSerializers.err(e[o]);else if(typeof e[o]=="object"&&!Array.isArray(e[o]))for(let i in e[o])t&&t.indexOf(i)>-1&&i in r&&(e[o][i]=r[i](e[o][i]))}function V(e,t,r){return function(){let n=new Array(1+arguments.length);n[0]=t;for(var o=1;o<n.length;o++)n[o]=arguments[o-1];return e[r].apply(this,n)}}function dr(e,t,r){let n=t.send,o=t.ts,i=t.methodLevel,a=t.methodValue,h=t.val,c=e._logEvent.bindings;se(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=o,e._logEvent.messages=r.filter(function(u){return c.indexOf(u)===-1}),e._logEvent.level.label=i,e._logEvent.level.value=a,n(i,e._logEvent,h),e._logEvent=Pe(c)}function Pe(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function pr(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function yr(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?dt:pt}function ie(){return{}}function Te(e){return e}function G(){}function dt(){return!1}function pt(){return Date.now()}function vr(){return Math.round(Date.now()/1e3)}function gr(){return new Date(Date.now()).toISOString()}function mr(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}});var Rt={};Le(Rt,{__assign:()=>He,__asyncDelegator:()=>Wr,__asyncGenerator:()=>Gr,__asyncValues:()=>Xr,__await:()=>Y,__awaiter:()=>Fr,__classPrivateFieldGet:()=>Qr,__classPrivateFieldSet:()=>en,__createBinding:()=>Vr,__decorate:()=>Mr,__exportStar:()=>Hr,__extends:()=>Dr,__generator:()=>Jr,__importDefault:()=>Zr,__importStar:()=>Yr,__makeTemplateObject:()=>Kr,__metadata:()=>kr,__param:()=>Ur,__read:()=>xt,__rest:()=>zr,__spread:()=>qr,__spreadArrays:()=>$r,__values:()=>qe});function Dr(e,t){Ve(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function zr(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function Mr(e,t,r,n){var o=arguments.length,i=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var h=e.length-1;h>=0;h--)(a=e[h])&&(i=(o<3?a(i):o>3?a(t,r,i):a(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}function Ur(e,t){return function(r,n){t(r,n,e)}}function kr(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Fr(e,t,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function h(p){try{u(n.next(p))}catch(l){a(l)}}function c(p){try{u(n.throw(p))}catch(l){a(l)}}function u(p){p.done?i(p.value):o(p.value).then(h,c)}u((n=n.apply(e,t||[])).next())})}function Jr(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function h(u){return function(p){return c([u,p])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=u[0]&2?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(p){u=[6,p],o=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Vr(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Hr(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function qe(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function xt(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(h){a={error:h}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i}function qr(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(xt(arguments[t]));return e}function $r(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;t<r;t++)for(var i=arguments[t],a=0,h=i.length;a<h;a++,o++)n[o]=i[a];return n}function Y(e){return this instanceof Y?(this.v=e,this):new Y(e)}function Gr(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),o,i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(b){n[b]&&(o[b]=function(d){return new Promise(function(w,C){i.push([b,d,w,C])>1||h(b,d)})})}function h(b,d){try{c(n[b](d))}catch(w){l(i[0][3],w)}}function c(b){b.value instanceof Y?Promise.resolve(b.value.v).then(u,p):l(i[0][2],b)}function u(b){h("next",b)}function p(b){h("throw",b)}function l(b,d){b(d),i.shift(),i.length&&h(i[0][0],i[0][1])}}function Wr(e){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,i){t[o]=e[o]?function(a){return(r=!r)?{value:Y(e[o](a)),done:o==="return"}:i?i(a):a}:i}}function Xr(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof qe=="function"?qe(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(a){return new Promise(function(h,c){a=e[i](a),o(h,c,a.done,a.value)})}}function o(i,a,h,c){Promise.resolve(c).then(function(u){i({value:u,done:h})},a)}}function Kr(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Yr(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Zr(e){return e&&e.__esModule?e:{default:e}}function Qr(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function en(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Ve,He,Lt=Qt(()=>{"use strict";Ve=function(e,t){return Ve=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},Ve(e,t)};He=function(){return He=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},He.apply(this,arguments)}});var At=U(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.isBrowserCryptoAvailable=I.getSubtleCrypto=I.getBrowerCrypto=void 0;function $e(){return(global==null?void 0:global.crypto)||(global==null?void 0:global.msCrypto)||{}}I.getBrowerCrypto=$e;function St(){let e=$e();return e.subtle||e.webkitSubtle}I.getSubtleCrypto=St;function tn(){return!!$e()&&!!St()}I.isBrowserCryptoAvailable=tn});var Ct=U(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.isBrowser=N.isNode=N.isReactNative=void 0;function Tt(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}N.isReactNative=Tt;function Pt(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}N.isNode=Pt;function rn(){return!Tt()&&!Pt()}N.isBrowser=rn});var Ge=U(ve=>{"use strict";Object.defineProperty(ve,"__esModule",{value:!0});var jt=(Lt(),er(Rt));jt.__exportStar(At(),ve);jt.__exportStar(Ct(),ve)});var kt=U((D,Ut)=>{"use strict";var Ee=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global,Oe=function(){function e(){this.fetch=!1,this.DOMException=Ee.DOMException}return e.prototype=Ee,new e}();(function(e){var t=function(r){var n=typeof e<"u"&&e||typeof self<"u"&&self||typeof global<"u"&&global||{},o={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function i(s){return s&&DataView.prototype.isPrototypeOf(s)}if(o.arrayBuffer)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(s){return s&&a.indexOf(Object.prototype.toString.call(s))>-1};function c(s){if(typeof s!="string"&&(s=String(s)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(s)||s==="")throw new TypeError('Invalid character in header field name: "'+s+'"');return s.toLowerCase()}function u(s){return typeof s!="string"&&(s=String(s)),s}function p(s){var f={next:function(){var y=s.shift();return{done:y===void 0,value:y}}};return o.iterable&&(f[Symbol.iterator]=function(){return f}),f}function l(s){this.map={},s instanceof l?s.forEach(function(f,y){this.append(y,f)},this):Array.isArray(s)?s.forEach(function(f){if(f.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+f.length);this.append(f[0],f[1])},this):s&&Object.getOwnPropertyNames(s).forEach(function(f){this.append(f,s[f])},this)}l.prototype.append=function(s,f){s=c(s),f=u(f);var y=this.map[s];this.map[s]=y?y+", "+f:f},l.prototype.delete=function(s){delete this.map[c(s)]},l.prototype.get=function(s){return s=c(s),this.has(s)?this.map[s]:null},l.prototype.has=function(s){return this.map.hasOwnProperty(c(s))},l.prototype.set=function(s,f){this.map[c(s)]=u(f)},l.prototype.forEach=function(s,f){for(var y in this.map)this.map.hasOwnProperty(y)&&s.call(f,this.map[y],y,this)},l.prototype.keys=function(){var s=[];return this.forEach(function(f,y){s.push(y)}),p(s)},l.prototype.values=function(){var s=[];return this.forEach(function(f){s.push(f)}),p(s)},l.prototype.entries=function(){var s=[];return this.forEach(function(f,y){s.push([y,f])}),p(s)},o.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);function b(s){if(!s._noBody){if(s.bodyUsed)return Promise.reject(new TypeError("Already read"));s.bodyUsed=!0}}function d(s){return new Promise(function(f,y){s.onload=function(){f(s.result)},s.onerror=function(){y(s.error)}})}function w(s){var f=new FileReader,y=d(f);return f.readAsArrayBuffer(s),y}function C(s){var f=new FileReader,y=d(f),m=/charset=([A-Za-z0-9_-]+)/.exec(s.type),_=m?m[1]:"utf-8";return f.readAsText(s,_),y}function ee(s){for(var f=new Uint8Array(s),y=new Array(f.length),m=0;m<f.length;m++)y[m]=String.fromCharCode(f[m]);return y.join("")}function z(s){if(s.slice)return s.slice(0);var f=new Uint8Array(s.byteLength);return f.set(new Uint8Array(s)),f.buffer}function q(){return this.bodyUsed=!1,this._initBody=function(s){this.bodyUsed=this.bodyUsed,this._bodyInit=s,s?typeof s=="string"?this._bodyText=s:o.blob&&Blob.prototype.isPrototypeOf(s)?this._bodyBlob=s:o.formData&&FormData.prototype.isPrototypeOf(s)?this._bodyFormData=s:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(s)?this._bodyText=s.toString():o.arrayBuffer&&o.blob&&i(s)?(this._bodyArrayBuffer=z(s.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(s)||h(s))?this._bodyArrayBuffer=z(s):this._bodyText=s=Object.prototype.toString.call(s):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof s=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(s)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var s=b(this);if(s)return s;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var s=b(this);return s||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(o.blob)return this.blob().then(w);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var s=b(this);if(s)return s;if(this._bodyBlob)return C(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ee(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(Kt)}),this.json=function(){return this.text().then(JSON.parse)},this}var te=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function A(s){var f=s.toUpperCase();return te.indexOf(f)>-1?f:s}function j(s,f){if(!(this instanceof j))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');f=f||{};var y=f.body;if(s instanceof j){if(s.bodyUsed)throw new TypeError("Already read");this.url=s.url,this.credentials=s.credentials,f.headers||(this.headers=new l(s.headers)),this.method=s.method,this.mode=s.mode,this.signal=s.signal,!y&&s._bodyInit!=null&&(y=s._bodyInit,s.bodyUsed=!0)}else this.url=String(s);if(this.credentials=f.credentials||this.credentials||"same-origin",(f.headers||!this.headers)&&(this.headers=new l(f.headers)),this.method=A(f.method||this.method||"GET"),this.mode=f.mode||this.mode||null,this.signal=f.signal||this.signal||function(){if("AbortController"in n){var v=new AbortController;return v.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&y)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(y),(this.method==="GET"||this.method==="HEAD")&&(f.cache==="no-store"||f.cache==="no-cache")){var m=/([?&])_=[^&]*/;if(m.test(this.url))this.url=this.url.replace(m,"$1_="+new Date().getTime());else{var _=/\?/;this.url+=(_.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}j.prototype.clone=function(){return new j(this,{body:this._bodyInit})};function Kt(s){var f=new FormData;return s.trim().split("&").forEach(function(y){if(y){var m=y.split("="),_=m.shift().replace(/\+/g," "),v=m.join("=").replace(/\+/g," ");f.append(decodeURIComponent(_),decodeURIComponent(v))}}),f}function Yt(s){var f=new l,y=s.replace(/\r?\n[\t ]+/g," ");return y.split("\r").map(function(m){return m.indexOf(`
`)===0?m.substr(1,m.length):m}).forEach(function(m){var _=m.split(":"),v=_.shift().trim();if(v){var re=_.join(":").trim();try{f.append(v,re)}catch(Re){console.warn("Response "+Re.message)}}}),f}q.call(j.prototype);function S(s,f){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(f||(f={}),this.type="default",this.status=f.status===void 0?200:f.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=f.statusText===void 0?"":""+f.statusText,this.headers=new l(f.headers),this.url=f.url||"",this._initBody(s)}q.call(S.prototype),S.prototype.clone=function(){return new S(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},S.error=function(){var s=new S(null,{status:200,statusText:""});return s.ok=!1,s.status=0,s.type="error",s};var Zt=[301,302,303,307,308];S.redirect=function(s,f){if(Zt.indexOf(f)===-1)throw new RangeError("Invalid status code");return new S(null,{status:f,headers:{location:s}})},r.DOMException=n.DOMException;try{new r.DOMException}catch{r.DOMException=function(f,y){this.message=f,this.name=y;var m=Error(f);this.stack=m.stack},r.DOMException.prototype=Object.create(Error.prototype),r.DOMException.prototype.constructor=r.DOMException}function xe(s,f){return new Promise(function(y,m){var _=new j(s,f);if(_.signal&&_.signal.aborted)return m(new r.DOMException("Aborted","AbortError"));var v=new XMLHttpRequest;function re(){v.abort()}v.onload=function(){var E={statusText:v.statusText,headers:Yt(v.getAllResponseHeaders()||"")};_.url.indexOf("file://")===0&&(v.status<200||v.status>599)?E.status=200:E.status=v.status,E.url="responseURL"in v?v.responseURL:E.headers.get("X-Request-URL");var M="response"in v?v.response:v.responseText;setTimeout(function(){y(new S(M,E))},0)},v.onerror=function(){setTimeout(function(){m(new TypeError("Network request failed"))},0)},v.ontimeout=function(){setTimeout(function(){m(new TypeError("Network request timed out"))},0)},v.onabort=function(){setTimeout(function(){m(new r.DOMException("Aborted","AbortError"))},0)};function Re(E){try{return E===""&&n.location.href?n.location.href:E}catch{return E}}if(v.open(_.method,Re(_.url),!0),_.credentials==="include"?v.withCredentials=!0:_.credentials==="omit"&&(v.withCredentials=!1),"responseType"in v&&(o.blob?v.responseType="blob":o.arrayBuffer&&(v.responseType="arraybuffer")),f&&typeof f.headers=="object"&&!(f.headers instanceof l||n.Headers&&f.headers instanceof n.Headers)){var Qe=[];Object.getOwnPropertyNames(f.headers).forEach(function(E){Qe.push(c(E)),v.setRequestHeader(E,u(f.headers[E]))}),_.headers.forEach(function(E,M){Qe.indexOf(M)===-1&&v.setRequestHeader(M,E)})}else _.headers.forEach(function(E,M){v.setRequestHeader(M,E)});_.signal&&(_.signal.addEventListener("abort",re),v.onreadystatechange=function(){v.readyState===4&&_.signal.removeEventListener("abort",re)}),v.send(typeof _._bodyInit>"u"?null:_._bodyInit)})}return xe.polyfill=!0,n.fetch||(n.fetch=xe,n.Headers=l,n.Request=j,n.Response=S),r.Headers=l,r.Request=j,r.Response=S,r.fetch=xe,Object.defineProperty(r,"__esModule",{value:!0}),r}({})})(Oe);Oe.fetch.ponyfill=!0;delete Oe.fetch.polyfill;var H=Ee.fetch?Ee:Oe;D=H.fetch;D.default=H.fetch;D.fetch=H.fetch;D.Headers=H.Headers;D.Request=H.Request;D.Response=H.Response;Ut.exports=D});var P=k(Ce()),wr=k(Ce());var br=e=>JSON.stringify(e,(t,r)=>typeof r=="bigint"?r.toString()+"n":r);function je(e){return typeof e=="string"?e:br(e)||""}var _r={level:"info"},W="custom_context",De=1e3*1024,Be=class{constructor(t){this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},ae=class{constructor(t){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){let r=new Be(t);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;let t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){let t=[],r=this.head;for(;r!==null;)t.push(r.value),r=r.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};let r=t.value;return t=t.next,{done:!1,value:r}}}}},fe=class{constructor(t,r=De){this.level=t??"error",this.levelValue=P.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new ae(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,r){r===P.levels.values.error?console.error(t):r===P.levels.values.warn?console.warn(t):r===P.levels.values.debug?console.debug(t):r===P.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(je({timestamp:new Date().toISOString(),log:t}));let r=typeof t=="string"?JSON.parse(t).level:t.level;r>=this.levelValue&&this.forwardToConsole(t,r)}getLogs(){return this.logs}clearLogs(){this.logs=new ae(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){let r=this.getLogArray();return r.push(je({extraMetadata:t})),new Blob(r,{type:"application/json"})}},Ie=class{constructor(t,r=De){this.baseChunkLogger=new fe(t,r)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){let r=URL.createObjectURL(this.logsToBlob(t)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}},Ne=class{constructor(t,r=De){this.baseChunkLogger=new fe(t,r)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}},Er=Object.defineProperty,Or=Object.defineProperties,xr=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,Rr=Object.prototype.hasOwnProperty,Lr=Object.prototype.propertyIsEnumerable,gt=(e,t,r)=>t in e?Er(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ce=(e,t)=>{for(var r in t||(t={}))Rr.call(t,r)&&gt(e,r,t[r]);if(vt)for(var r of vt(t))Lr.call(t,r)&&gt(e,r,t[r]);return e},ue=(e,t)=>Or(e,xr(t));function An(e){return ue(ce({},e),{level:e?.level||_r.level})}function Sr(e,t=W){return e[t]||""}function Ar(e,t,r=W){return e[r]=t,e}function Tr(e,t=W){let r="";return typeof e.bindings>"u"?r=Sr(e,t):r=e.bindings().context||"",r}function Pr(e,t,r=W){let n=Tr(e,r);return n.trim()?`${n}/${t}`:t}function Tn(e,t,r=W){let n=Pr(e,t,r),o=e.child({context:n});return Ar(o,n,r)}function Cr(e){var t,r;let n=new Ie((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:(0,P.default)(ue(ce({},e.opts),{level:"trace",browser:ue(ce({},(r=e.opts)==null?void 0:r.browser),{write:o=>n.write(o)})})),chunkLoggerController:n}}function jr(e){var t;let r=new Ne((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:(0,P.default)(ue(ce({},e.opts),{level:"trace"}),r),chunkLoggerController:r}}function Pn(e){return typeof e.loggerOverride<"u"&&typeof e.loggerOverride!="string"?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Cr(e):jr(e)}var mt="PARSE_ERROR",bt="INVALID_REQUEST",wt="METHOD_NOT_FOUND",_t="INVALID_PARAMS",le="INTERNAL_ERROR",X="SERVER_ERROR",ze=[-32700,-32600,-32601,-32602,-32603],he=[-32e3,-32099],B={[mt]:{code:-32700,message:"Parse error"},[bt]:{code:-32600,message:"Invalid Request"},[wt]:{code:-32601,message:"Method not found"},[_t]:{code:-32602,message:"Invalid params"},[le]:{code:-32603,message:"Internal error"},[X]:{code:-32e3,message:"Server error"}},K=X;function Br(e){return e<=he[0]&&e>=he[1]}function de(e){return ze.includes(e)}function Et(e){return typeof e=="number"}function pe(e){return Object.keys(B).includes(e)?B[e]:B[K]}function ye(e){let t=Object.values(B).find(r=>r.code===e);return t||B[K]}function Ir(e){if(typeof e.error.code>"u")return{valid:!1,error:"Missing code for JSON-RPC error"};if(typeof e.error.message>"u")return{valid:!1,error:"Missing message for JSON-RPC error"};if(!Et(e.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${e.error.code}`};if(de(e.error.code)){let t=ye(e.error.code);if(t.message!==B[K].message&&e.error.message===t.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${e.error.code}`}}return{valid:!0}}function Me(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}function Ue(e=3){let t=Date.now()*Math.pow(10,e),r=Math.floor(Math.random()*Math.pow(10,e));return t+r}function ke(e=6){return BigInt(Ue(e))}function Fe(e,t,r){return{id:r||Ue(),jsonrpc:"2.0",method:e,params:t}}function Nr(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Je(e,t,r){return{id:e,jsonrpc:"2.0",error:Ot(t,r)}}function Ot(e,t){return typeof e>"u"?pe(le):(typeof e=="string"&&(e=Object.assign(Object.assign({},pe(X)),{message:e})),typeof t<"u"&&(e.data=t),de(e.code)&&(e=ye(e.code)),e)}var L={};Le(L,{DEFAULT_ERROR:()=>K,IBaseJsonRpcProvider:()=>be,IEvents:()=>Z,IJsonRpcConnection:()=>We,IJsonRpcProvider:()=>Q,INTERNAL_ERROR:()=>le,INVALID_PARAMS:()=>_t,INVALID_REQUEST:()=>bt,METHOD_NOT_FOUND:()=>wt,PARSE_ERROR:()=>mt,RESERVED_ERROR_CODES:()=>ze,SERVER_ERROR:()=>X,SERVER_ERROR_CODE_RANGE:()=>he,STANDARD_ERROR_MAP:()=>B,formatErrorMessage:()=>Ot,formatJsonRpcError:()=>Je,formatJsonRpcRequest:()=>Fe,formatJsonRpcResult:()=>Nr,getBigIntRpcId:()=>ke,getError:()=>pe,getErrorByCode:()=>ye,isHttpUrl:()=>we,isJsonRpcError:()=>_e,isJsonRpcPayload:()=>Xe,isJsonRpcRequest:()=>hn,isJsonRpcResponse:()=>Ke,isJsonRpcResult:()=>Dt,isJsonRpcValidationInvalid:()=>dn,isLocalhostUrl:()=>ln,isNodeJs:()=>It,isReservedErrorCode:()=>de,isServerErrorCode:()=>Br,isValidDefaultRoute:()=>ge,isValidErrorCode:()=>Et,isValidLeadingWildcardRoute:()=>on,isValidRoute:()=>nn,isValidTrailingWildcardRoute:()=>sn,isValidWildcardRoute:()=>me,isWsUrl:()=>un,parseConnectionError:()=>Me,payloadId:()=>Ue,validateJsonRpcError:()=>Ir});var O={};Le(O,{isNodeJs:()=>It});var Bt=k(Ge());x(O,k(Ge()));var It=Bt.isNode;x(L,O);function nn(e){return e.includes("*")?me(e):!/\W/g.test(e)}function ge(e){return e==="*"}function me(e){return ge(e)?!0:!(!e.includes("*")||e.split("*").length!==2||e.split("*").filter(t=>t.trim()==="").length!==1)}function on(e){return!ge(e)&&me(e)&&!e.split("*")[0].trim()}function sn(e){return!ge(e)&&me(e)&&!e.split("*")[1].trim()}var Z=class{},We=class extends Z{constructor(t){super()}},be=class extends Z{constructor(){super()}},Q=class extends be{constructor(t){super()}};var an="^https?:",fn="^wss?:";function cn(e){let t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Nt(e,t){let r=cn(e);return typeof r>"u"?!1:new RegExp(t).test(r)}function we(e){return Nt(e,an)}function un(e){return Nt(e,fn)}function ln(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function Xe(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function hn(e){return Xe(e)&&"method"in e}function Ke(e){return Xe(e)&&(Dt(e)||_e(e))}function Dt(e){return"result"in e}function _e(e){return"error"in e}function dn(e){return"error"in e&&e.valid===!1}var Mt=k(Ae());var zt=class extends Q{constructor(t){super(t),this.events=new Mt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}connect(){return R(this,arguments,function*(t=this.connection){yield this.open(t)})}disconnect(){return R(this,null,function*(){yield this.close()})}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}request(t,r){return R(this,null,function*(){return this.requestStrict(Fe(t.method,t.params||[],t.id||ke().toString()),r)})}requestStrict(t,r){return R(this,null,function*(){return new Promise((n,o)=>R(this,null,function*(){if(!this.connection.connected)try{yield this.open()}catch(i){o(i)}this.events.on(`${t.id}`,i=>{_e(i)?o(i.error):n(i.result)});try{yield this.connection.send(t,r)}catch(i){o(i)}}))})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Ke(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}open(){return R(this,arguments,function*(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(yield this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),yield this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))})}close(){return R(this,null,function*(){yield this.connection.close()})}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};var Xt=k(Ae()),Ze=k(kt());var pn=e=>JSON.stringify(e,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),yn=e=>{let t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=e.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ft(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return yn(e)}catch{return e}}function Ye(e){return typeof e=="string"?e:pn(e)||""}var vn=Object.defineProperty,gn=Object.defineProperties,mn=Object.getOwnPropertyDescriptors,Jt=Object.getOwnPropertySymbols,bn=Object.prototype.hasOwnProperty,wn=Object.prototype.propertyIsEnumerable,Vt=(e,t,r)=>t in e?vn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ht=(e,t)=>{for(var r in t||(t={}))bn.call(t,r)&&Vt(e,r,t[r]);if(Jt)for(var r of Jt(t))wn.call(t,r)&&Vt(e,r,t[r]);return e},qt=(e,t)=>gn(e,mn(t)),_n={Accept:"application/json","Content-Type":"application/json"},En="POST",$t={headers:_n,method:En},Gt=10,Wt=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Xt.EventEmitter,this.isAvailable=!1,this.registering=!1,!we(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}open(){return R(this,arguments,function*(t=this.url){yield this.register(t)})}close(){return R(this,null,function*(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()})}send(t){return R(this,null,function*(){this.isAvailable||(yield this.register());try{let r=Ye(t),n=yield(yield(0,Ze.default)(this.url,qt(Ht({},$t),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(t.id,r)}})}register(){return R(this,arguments,function*(t=this.url){if(!we(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){let r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),o(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){let r=Ye({id:1,jsonrpc:"2.0",method:"test",params:[]});yield(0,Ze.default)(t,qt(Ht({},$t),{body:r}))}this.onOpen()}catch(r){let n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}})}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;let r=typeof t.data=="string"?Ft(t.data):t.data;this.events.emit("payload",r)}onError(t,r){let n=this.parseError(r),o=n.message||n.toString(),i=Je(t,o);this.events.emit("payload",i)}parseError(t,r=this.url){return Me(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Gt&&this.events.setMaxListeners(Gt)}};export{Ae as a,wr as b,An as c,Tr as d,Tn as e,Pn as f,Me as g,Ue as h,ke as i,Fe as j,Nr as k,Je as l,un as m,ln as n,hn as o,Ke as p,Dt as q,_e as r,L as s,zt as t,Wt as u};
