import{a as kt,b as yt,c as Et,d as qt,e as Zt,f as ee,g as K,h as ne,i as tt,j as re,k as M,l as W,m as Mt,n as Bt,o as et,p as Ae,q as xt,r as Le,s as nt,t as oe}from"./chunk-V4X6BPGN.js";import{a as j,b as F}from"./chunk-HIVZEDT5.js";function He(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function cn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function vt(t,...n){if(!cn(t))throw new Error("Uint8Array expected");if(n.length>0&&!n.includes(t.length))throw new Error("Uint8Array expected of length "+n+", got length="+t.length)}function _e(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");He(t.outputLen),He(t.blockLen)}function St(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")}function Ie(t,n){vt(t);let e=n.outputLen;if(t.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}var bt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Vt(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Q(t,n){return t<<32-n|t>>>n}var ur=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function";function fn(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Nt(t){return typeof t=="string"&&(t=fn(t)),vt(t),t}function Oe(...t){let n=0;for(let r=0;r<t.length;r++){let o=t[r];vt(o),n+=o.length}let e=new Uint8Array(n);for(let r=0,o=0;r<t.length;r++){let s=t[r];e.set(s,o),o+=s.length}return e}var At=class{clone(){return this._cloneInto()}};function Dt(t){let n=r=>t().update(Nt(r)).digest(),e=t();return n.outputLen=e.outputLen,n.blockLen=e.blockLen,n.create=()=>t(),n}function jt(t=32){if(bt&&typeof bt.getRandomValues=="function")return bt.getRandomValues(new Uint8Array(t));if(bt&&typeof bt.randomBytes=="function")return Uint8Array.from(bt.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function an(t,n,e,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(n,e,r);let o=BigInt(32),s=BigInt(4294967295),c=Number(e>>o&s),f=Number(e&s),i=r?4:0,d=r?0:4;t.setUint32(n+i,c,r),t.setUint32(n+d,f,r)}function qe(t,n,e){return t&n^~t&e}function Ne(t,n,e){return t&n^t&e^n&e}var Lt=class extends At{constructor(n,e,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=n,this.outputLen=e,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(n),this.view=Vt(this.buffer)}update(n){St(this);let{view:e,buffer:r,blockLen:o}=this;n=Nt(n);let s=n.length;for(let c=0;c<s;){let f=Math.min(o-this.pos,s-c);if(f===o){let i=Vt(n);for(;o<=s-c;c+=o)this.process(i,c);continue}r.set(n.subarray(c,c+f),this.pos),this.pos+=f,c+=f,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=n.length,this.roundClean(),this}digestInto(n){St(this),Ie(n,this),this.finished=!0;let{buffer:e,view:r,blockLen:o,isLE:s}=this,{pos:c}=this;e[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>o-c&&(this.process(r,0),c=0);for(let l=c;l<o;l++)e[l]=0;an(r,o-8,BigInt(this.length*8),s),this.process(r,0);let f=Vt(n),i=this.outputLen;if(i%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let d=i/4,h=this.get();if(d>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<d;l++)f.setUint32(4*l,h[l],s)}digest(){let{buffer:n,outputLen:e}=this;this.digestInto(n);let r=n.slice(0,e);return this.destroy(),r}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());let{blockLen:e,buffer:r,length:o,finished:s,destroyed:c,pos:f}=this;return n.length=o,n.pos=f,n.finished=s,n.destroyed=c,o%e&&n.buffer.set(r),n}};var dn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),st=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),it=new Uint32Array(64),se=class extends Lt{constructor(n=32){super(64,n,8,!1),this.A=st[0]|0,this.B=st[1]|0,this.C=st[2]|0,this.D=st[3]|0,this.E=st[4]|0,this.F=st[5]|0,this.G=st[6]|0,this.H=st[7]|0}get(){let{A:n,B:e,C:r,D:o,E:s,F:c,G:f,H:i}=this;return[n,e,r,o,s,c,f,i]}set(n,e,r,o,s,c,f,i){this.A=n|0,this.B=e|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=c|0,this.G=f|0,this.H=i|0}process(n,e){for(let l=0;l<16;l++,e+=4)it[l]=n.getUint32(e,!1);for(let l=16;l<64;l++){let u=it[l-15],m=it[l-2],S=Q(u,7)^Q(u,18)^u>>>3,g=Q(m,17)^Q(m,19)^m>>>10;it[l]=g+it[l-7]+S+it[l-16]|0}let{A:r,B:o,C:s,D:c,E:f,F:i,G:d,H:h}=this;for(let l=0;l<64;l++){let u=Q(f,6)^Q(f,11)^Q(f,25),m=h+u+qe(f,i,d)+dn[l]+it[l]|0,g=(Q(r,2)^Q(r,13)^Q(r,22))+Ne(r,o,s)|0;h=d,d=i,i=f,f=c+m|0,c=s,s=o,o=r,r=m+g|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,c=c+this.D|0,f=f+this.E|0,i=i+this.F|0,d=d+this.G|0,h=h+this.H|0,this.set(r,o,s,c,f,i,d,h)}roundClean(){it.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Ht=Dt(()=>new se);var zt=BigInt(4294967295),ie=BigInt(32);function Ce(t,n=!1){return n?{h:Number(t&zt),l:Number(t>>ie&zt)}:{h:Number(t>>ie&zt)|0,l:Number(t&zt)|0}}function ln(t,n=!1){let e=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let o=0;o<t.length;o++){let{h:s,l:c}=Ce(t[o],n);[e[o],r[o]]=[s,c]}return[e,r]}var un=(t,n)=>BigInt(t>>>0)<<ie|BigInt(n>>>0),hn=(t,n,e)=>t>>>e,xn=(t,n,e)=>t<<32-e|n>>>e,bn=(t,n,e)=>t>>>e|n<<32-e,gn=(t,n,e)=>t<<32-e|n>>>e,mn=(t,n,e)=>t<<64-e|n>>>e-32,pn=(t,n,e)=>t>>>e-32|n<<64-e,wn=(t,n)=>n,yn=(t,n)=>t,En=(t,n,e)=>t<<e|n>>>32-e,Bn=(t,n,e)=>n<<e|t>>>32-e,vn=(t,n,e)=>n<<e-32|t>>>64-e,Sn=(t,n,e)=>t<<e-32|n>>>64-e;function An(t,n,e,r){let o=(n>>>0)+(r>>>0);return{h:t+e+(o/2**32|0)|0,l:o|0}}var Ln=(t,n,e)=>(t>>>0)+(n>>>0)+(e>>>0),Hn=(t,n,e,r)=>n+e+r+(t/2**32|0)|0,_n=(t,n,e,r)=>(t>>>0)+(n>>>0)+(e>>>0)+(r>>>0),In=(t,n,e,r,o)=>n+e+r+o+(t/2**32|0)|0,On=(t,n,e,r,o)=>(t>>>0)+(n>>>0)+(e>>>0)+(r>>>0)+(o>>>0),qn=(t,n,e,r,o,s)=>n+e+r+o+s+(t/2**32|0)|0;var Nn={fromBig:Ce,split:ln,toBig:un,shrSH:hn,shrSL:xn,rotrSH:bn,rotrSL:gn,rotrBH:mn,rotrBL:pn,rotr32H:wn,rotr32L:yn,rotlSH:En,rotlSL:Bn,rotlBH:vn,rotlBL:Sn,add:An,add3L:Ln,add3H:Hn,add4L:_n,add4H:In,add5H:qn,add5L:On},I=Nn;var[Cn,Tn]=I.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ct=new Uint32Array(80),ft=new Uint32Array(80),ce=class extends Lt{constructor(n=64){super(128,n,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:n,Al:e,Bh:r,Bl:o,Ch:s,Cl:c,Dh:f,Dl:i,Eh:d,El:h,Fh:l,Fl:u,Gh:m,Gl:S,Hh:g,Hl:a}=this;return[n,e,r,o,s,c,f,i,d,h,l,u,m,S,g,a]}set(n,e,r,o,s,c,f,i,d,h,l,u,m,S,g,a){this.Ah=n|0,this.Al=e|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=c|0,this.Dh=f|0,this.Dl=i|0,this.Eh=d|0,this.El=h|0,this.Fh=l|0,this.Fl=u|0,this.Gh=m|0,this.Gl=S|0,this.Hh=g|0,this.Hl=a|0}process(n,e){for(let x=0;x<16;x++,e+=4)ct[x]=n.getUint32(e),ft[x]=n.getUint32(e+=4);for(let x=16;x<80;x++){let E=ct[x-15]|0,_=ft[x-15]|0,H=I.rotrSH(E,_,1)^I.rotrSH(E,_,8)^I.shrSH(E,_,7),A=I.rotrSL(E,_,1)^I.rotrSL(E,_,8)^I.shrSL(E,_,7),L=ct[x-2]|0,v=ft[x-2]|0,R=I.rotrSH(L,v,19)^I.rotrBH(L,v,61)^I.shrSH(L,v,6),C=I.rotrSL(L,v,19)^I.rotrBL(L,v,61)^I.shrSL(L,v,6),q=I.add4L(A,C,ft[x-7],ft[x-16]),D=I.add4H(q,H,R,ct[x-7],ct[x-16]);ct[x]=D|0,ft[x]=q|0}let{Ah:r,Al:o,Bh:s,Bl:c,Ch:f,Cl:i,Dh:d,Dl:h,Eh:l,El:u,Fh:m,Fl:S,Gh:g,Gl:a,Hh:b,Hl:p}=this;for(let x=0;x<80;x++){let E=I.rotrSH(l,u,14)^I.rotrSH(l,u,18)^I.rotrBH(l,u,41),_=I.rotrSL(l,u,14)^I.rotrSL(l,u,18)^I.rotrBL(l,u,41),H=l&m^~l&g,A=u&S^~u&a,L=I.add5L(p,_,A,Tn[x],ft[x]),v=I.add5H(L,b,E,H,Cn[x],ct[x]),R=L|0,C=I.rotrSH(r,o,28)^I.rotrBH(r,o,34)^I.rotrBH(r,o,39),q=I.rotrSL(r,o,28)^I.rotrBL(r,o,34)^I.rotrBL(r,o,39),D=r&s^r&f^s&f,w=o&c^o&i^c&i;b=g|0,p=a|0,g=m|0,a=S|0,m=l|0,S=u|0,{h:l,l:u}=I.add(d|0,h|0,v|0,R|0),d=f|0,h=i|0,f=s|0,i=c|0,s=r|0,c=o|0;let y=I.add3L(R,q,w);r=I.add3H(y,v,C,D),o=y|0}({h:r,l:o}=I.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:c}=I.add(this.Bh|0,this.Bl|0,s|0,c|0),{h:f,l:i}=I.add(this.Ch|0,this.Cl|0,f|0,i|0),{h:d,l:h}=I.add(this.Dh|0,this.Dl|0,d|0,h|0),{h:l,l:u}=I.add(this.Eh|0,this.El|0,l|0,u|0),{h:m,l:S}=I.add(this.Fh|0,this.Fl|0,m|0,S|0),{h:g,l:a}=I.add(this.Gh|0,this.Gl|0,g|0,a|0),{h:b,l:p}=I.add(this.Hh|0,this.Hl|0,b|0,p|0),this.set(r,o,s,c,f,i,d,h,l,u,m,S,g,a,b,p)}roundClean(){ct.fill(0),ft.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Un=Dt(()=>new ce);var Gt=class extends At{constructor(n,e){super(),this.finished=!1,this.destroyed=!1,_e(n);let r=Nt(e);if(this.iHash=n.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?n.create().update(r).digest():r);for(let c=0;c<s.length;c++)s[c]^=54;this.iHash.update(s),this.oHash=n.create();for(let c=0;c<s.length;c++)s[c]^=106;this.oHash.update(s),s.fill(0)}update(n){return St(this),this.iHash.update(n),this}digestInto(n){St(this),vt(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){let n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:o,destroyed:s,blockLen:c,outputLen:f}=this;return n=n,n.finished=o,n.destroyed=s,n.blockLen=c,n.outputLen=f,n.oHash=e._cloneInto(n.oHash),n.iHash=r._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},fe=(t,n,e)=>new Gt(t,n).update(e).digest();fe.create=(t,n)=>new Gt(t,n);var V=BigInt(0),U=BigInt(1),gt=BigInt(2),Rn=BigInt(3),ae=BigInt(4),Te=BigInt(5),Ue=BigInt(8),kn=BigInt(9),Zn=BigInt(16);function k(t,n){let e=t%n;return e>=V?e:n+e}function Mn(t,n,e){if(n<V)throw new Error("invalid exponent, negatives unsupported");if(e<=V)throw new Error("invalid modulus");if(e===U)return V;let r=U;for(;n>V;)n&U&&(r=r*t%e),t=t*t%e,n>>=U;return r}function Y(t,n,e){let r=t;for(;n-- >V;)r*=r,r%=e;return r}function Pt(t,n){if(t===V)throw new Error("invert: expected non-zero number");if(n<=V)throw new Error("invert: expected positive modulus, got "+n);let e=k(t,n),r=n,o=V,s=U,c=U,f=V;for(;e!==V;){let d=r/e,h=r%e,l=o-c*d,u=s-f*d;r=e,e=h,o=c,s=f,c=l,f=u}if(r!==U)throw new Error("invert: does not exist");return k(o,n)}function Vn(t){let n=(t-U)/gt,e,r,o;for(e=t-U,r=0;e%gt===V;e/=gt,r++);for(o=gt;o<t&&Mn(o,n,t)!==t-U;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){let c=(t+U)/ae;return function(i,d){let h=i.pow(d,c);if(!i.eql(i.sqr(h),d))throw new Error("Cannot find square root");return h}}let s=(e+U)/gt;return function(f,i){if(f.pow(i,n)===f.neg(f.ONE))throw new Error("Cannot find square root");let d=r,h=f.pow(f.mul(f.ONE,o),e),l=f.pow(i,s),u=f.pow(i,e);for(;!f.eql(u,f.ONE);){if(f.eql(u,f.ZERO))return f.ZERO;let m=1;for(let g=f.sqr(u);m<d&&!f.eql(g,f.ONE);m++)g=f.sqr(g);let S=f.pow(h,U<<BigInt(d-m-1));h=f.sqr(S),l=f.mul(l,S),u=f.mul(u,h),d=m}return l}}function Dn(t){if(t%ae===Rn){let n=(t+U)/ae;return function(r,o){let s=r.pow(o,n);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(t%Ue===Te){let n=(t-Te)/Ue;return function(r,o){let s=r.mul(o,gt),c=r.pow(s,n),f=r.mul(o,c),i=r.mul(r.mul(f,gt),c),d=r.mul(f,r.sub(i,r.ONE));if(!r.eql(r.sqr(d),o))throw new Error("Cannot find square root");return d}}return t%Zn,Vn(t)}var kr=(t,n)=>(k(t,n)&U)===U,jn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Kt(t){let n={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=jn.reduce((r,o)=>(r[o]="function",r),n);return nt(t,e)}function zn(t,n,e){if(e<V)throw new Error("invalid exponent, negatives unsupported");if(e===V)return t.ONE;if(e===U)return n;let r=t.ONE,o=n;for(;e>V;)e&U&&(r=t.mul(r,o)),o=t.sqr(o),e>>=U;return r}function Gn(t,n){let e=new Array(n.length),r=n.reduce((s,c,f)=>t.is0(c)?s:(e[f]=s,t.mul(s,c)),t.ONE),o=t.inv(r);return n.reduceRight((s,c,f)=>t.is0(c)?s:(e[f]=t.mul(s,e[f]),t.mul(s,c)),o),e}function de(t,n){let e=n!==void 0?n:t.toString(2).length,r=Math.ceil(e/8);return{nBitLength:e,nByteLength:r}}function Wt(t,n,e=!1,r={}){if(t<=V)throw new Error("invalid field: expected ORDER > 0, got "+t);let{nBitLength:o,nByteLength:s}=de(t,n);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c,f=Object.freeze({ORDER:t,isLE:e,BITS:o,BYTES:s,MASK:xt(o),ZERO:V,ONE:U,create:i=>k(i,t),isValid:i=>{if(typeof i!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof i);return V<=i&&i<t},is0:i=>i===V,isOdd:i=>(i&U)===U,neg:i=>k(-i,t),eql:(i,d)=>i===d,sqr:i=>k(i*i,t),add:(i,d)=>k(i+d,t),sub:(i,d)=>k(i-d,t),mul:(i,d)=>k(i*d,t),pow:(i,d)=>zn(f,i,d),div:(i,d)=>k(i*Pt(d,t),t),sqrN:i=>i*i,addN:(i,d)=>i+d,subN:(i,d)=>i-d,mulN:(i,d)=>i*d,inv:i=>Pt(i,t),sqrt:r.sqrt||(i=>(c||(c=Dn(t)),c(f,i))),invertBatch:i=>Gn(f,i),cmov:(i,d,h)=>h?d:i,toBytes:i=>e?re(i,s):tt(i,s),fromBytes:i=>{if(i.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+i.length);return e?ne(i):K(i)}});return Object.freeze(f)}function Re(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let n=t.toString(2).length;return Math.ceil(n/8)}function le(t){let n=Re(t);return n+Math.ceil(n/2)}function ke(t,n,e=!1){let r=t.length,o=Re(n),s=le(n);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);let c=e?ne(t):K(t),f=k(c,n-U)+U;return e?re(f,o):tt(f,o)}var Ze=BigInt(0),ge=BigInt(1);function ue(t,n){let e=n.negate();return t?e:n}function Ve(t,n){if(!Number.isSafeInteger(t)||t<=0||t>n)throw new Error("invalid window size, expected [1.."+n+"], got W="+t)}function he(t,n){Ve(t,n);let e=Math.ceil(n/t)+1,r=2**(t-1),o=2**t,s=xt(t),c=BigInt(t);return{windows:e,windowSize:r,mask:s,maxNumber:o,shiftBy:c}}function Me(t,n,e){let{windowSize:r,mask:o,maxNumber:s,shiftBy:c}=e,f=Number(t&o),i=t>>c;f>r&&(f-=s,i+=ge);let d=n*r,h=d+Math.abs(f)-1,l=f===0,u=f<0,m=n%2!==0;return{nextN:i,offset:h,isZero:l,isNeg:u,isNegF:m,offsetF:d}}function Pn(t,n){if(!Array.isArray(t))throw new Error("array expected");t.forEach((e,r)=>{if(!(e instanceof n))throw new Error("invalid point at index "+r)})}function Kn(t,n){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((e,r)=>{if(!n.isValid(e))throw new Error("invalid scalar at index "+r)})}var xe=new WeakMap,De=new WeakMap;function be(t){return De.get(t)||1}function je(t,n){return{constTimeNegate:ue,hasPrecomputes(e){return be(e)!==1},unsafeLadder(e,r,o=t.ZERO){let s=e;for(;r>Ze;)r&ge&&(o=o.add(s)),s=s.double(),r>>=ge;return o},precomputeWindow(e,r){let{windows:o,windowSize:s}=he(r,n),c=[],f=e,i=f;for(let d=0;d<o;d++){i=f,c.push(i);for(let h=1;h<s;h++)i=i.add(f),c.push(i);f=i.double()}return c},wNAF(e,r,o){let s=t.ZERO,c=t.BASE,f=he(e,n);for(let i=0;i<f.windows;i++){let{nextN:d,offset:h,isZero:l,isNeg:u,isNegF:m,offsetF:S}=Me(o,i,f);o=d,l?c=c.add(ue(m,r[S])):s=s.add(ue(u,r[h]))}return{p:s,f:c}},wNAFUnsafe(e,r,o,s=t.ZERO){let c=he(e,n);for(let f=0;f<c.windows&&o!==Ze;f++){let{nextN:i,offset:d,isZero:h,isNeg:l}=Me(o,f,c);if(o=i,!h){let u=r[d];s=s.add(l?u.negate():u)}}return s},getPrecomputes(e,r,o){let s=xe.get(r);return s||(s=this.precomputeWindow(r,e),e!==1&&xe.set(r,o(s))),s},wNAFCached(e,r,o){let s=be(e);return this.wNAF(s,this.getPrecomputes(s,e,o),r)},wNAFCachedUnsafe(e,r,o,s){let c=be(e);return c===1?this.unsafeLadder(e,r,s):this.wNAFUnsafe(c,this.getPrecomputes(c,e,o),r,s)},setWindowSize(e,r){Ve(r,n),De.set(e,r),xe.delete(e)}}}function ze(t,n,e,r){if(Pn(e,t),Kn(r,n),e.length!==r.length)throw new Error("arrays of points and scalars must have equal length");let o=t.ZERO,s=Ae(BigInt(e.length)),c=s>12?s-3:s>4?s-2:s?2:1,f=xt(c),i=new Array(Number(f)+1).fill(o),d=Math.floor((n.BITS-1)/c)*c,h=o;for(let l=d;l>=0;l-=c){i.fill(o);for(let m=0;m<r.length;m++){let S=r[m],g=Number(S>>BigInt(l)&f);i[g]=i[g].add(e[m])}let u=o;for(let m=i.length-1,S=o;m>0;m--)S=S.add(i[m]),u=u.add(S);if(h=h.add(u),l!==0)for(let m=0;m<c;m++)h=h.double()}return h}function me(t){return Kt(t.Fp),nt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(F(j(j({},de(t.n,t.nBitLength)),t),{p:t.Fp.ORDER}))}function Ge(t){t.lowS!==void 0&&Et("lowS",t.lowS),t.prehash!==void 0&&Et("prehash",t.prehash)}function Wn(t){let n=me(t);nt(n,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:e,Fp:r,a:o}=n;if(e){if(!r.eql(o,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze(j({},n))}var pe=class extends Error{constructor(n=""){super(n)}},rt={Err:pe,_tlv:{encode:(t,n)=>{let{Err:e}=rt;if(t<0||t>256)throw new e("tlv.encode: wrong tag");if(n.length&1)throw new e("tlv.encode: unpadded data");let r=n.length/2,o=qt(r);if(o.length/2&128)throw new e("tlv.encode: long form length too big");let s=r>127?qt(o.length/2|128):"";return qt(t)+s+o+n},decode(t,n){let{Err:e}=rt,r=0;if(t<0||t>256)throw new e("tlv.encode: wrong tag");if(n.length<2||n[r++]!==t)throw new e("tlv.decode: wrong tlv");let o=n[r++],s=!!(o&128),c=0;if(!s)c=o;else{let i=o&127;if(!i)throw new e("tlv.decode(long): indefinite length not supported");if(i>4)throw new e("tlv.decode(long): byte length is too big");let d=n.subarray(r,r+i);if(d.length!==i)throw new e("tlv.decode: length bytes not complete");if(d[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(let h of d)c=c<<8|h;if(r+=i,c<128)throw new e("tlv.decode(long): not minimal encoding")}let f=n.subarray(r,r+c);if(f.length!==c)throw new e("tlv.decode: wrong value length");return{v:f,l:n.subarray(r+c)}}},_int:{encode(t){let{Err:n}=rt;if(t<J)throw new n("integer: negative integers are not allowed");let e=qt(t);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new n("unexpected DER parsing assertion: unpadded hex");return e},decode(t){let{Err:n}=rt;if(t[0]&128)throw new n("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new n("invalid signature integer: unnecessary leading zero");return K(t)}},toSig(t){let{Err:n,_int:e,_tlv:r}=rt,o=M("signature",t),{v:s,l:c}=r.decode(48,o);if(c.length)throw new n("invalid signature: left bytes after parsing");let{v:f,l:i}=r.decode(2,s),{v:d,l:h}=r.decode(2,i);if(h.length)throw new n("invalid signature: left bytes after parsing");return{r:e.decode(f),s:e.decode(d)}},hexFromSig(t){let{_tlv:n,_int:e}=rt,r=n.encode(2,e.encode(t.r)),o=n.encode(2,e.encode(t.s)),s=r+o;return n.encode(48,s)}},J=BigInt(0),T=BigInt(1),at=BigInt(2),Yt=BigInt(3),Pe=BigInt(4);function Yn(t){let n=Wn(t),{Fp:e}=n,r=Wt(n.n,n.nBitLength),o=n.toBytes||((g,a,b)=>{let p=a.toAffine();return W(Uint8Array.from([4]),e.toBytes(p.x),e.toBytes(p.y))}),s=n.fromBytes||(g=>{let a=g.subarray(1),b=e.fromBytes(a.subarray(0,e.BYTES)),p=e.fromBytes(a.subarray(e.BYTES,2*e.BYTES));return{x:b,y:p}});function c(g){let{a,b}=n,p=e.sqr(g),x=e.mul(p,g);return e.add(e.add(x,e.mul(g,a)),b)}if(!e.eql(e.sqr(n.Gy),c(n.Gx)))throw new Error("bad generator point: equation left != right");function f(g){return Bt(g,T,n.n)}function i(g){let{allowedPrivateKeyLengths:a,nByteLength:b,wrapPrivateKey:p,n:x}=n;if(a&&typeof g!="bigint"){if(kt(g)&&(g=Zt(g)),typeof g!="string"||!a.includes(g.length))throw new Error("invalid private key");g=g.padStart(b*2,"0")}let E;try{E=typeof g=="bigint"?g:K(M("private key",g,b))}catch{throw new Error("invalid private key, expected hex or "+b+" bytes, got "+typeof g)}return p&&(E=k(E,x)),et("private key",E,T,x),E}function d(g){if(!(g instanceof u))throw new Error("ProjectivePoint expected")}let h=oe((g,a)=>{let{px:b,py:p,pz:x}=g;if(e.eql(x,e.ONE))return{x:b,y:p};let E=g.is0();a==null&&(a=E?e.ONE:e.inv(x));let _=e.mul(b,a),H=e.mul(p,a),A=e.mul(x,a);if(E)return{x:e.ZERO,y:e.ZERO};if(!e.eql(A,e.ONE))throw new Error("invZ was invalid");return{x:_,y:H}}),l=oe(g=>{if(g.is0()){if(n.allowInfinityPoint&&!e.is0(g.py))return;throw new Error("bad point: ZERO")}let{x:a,y:b}=g.toAffine();if(!e.isValid(a)||!e.isValid(b))throw new Error("bad point: x or y not FE");let p=e.sqr(b),x=c(a);if(!e.eql(p,x))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class u{constructor(a,b,p){if(a==null||!e.isValid(a))throw new Error("x required");if(b==null||!e.isValid(b))throw new Error("y required");if(p==null||!e.isValid(p))throw new Error("z required");this.px=a,this.py=b,this.pz=p,Object.freeze(this)}static fromAffine(a){let{x:b,y:p}=a||{};if(!a||!e.isValid(b)||!e.isValid(p))throw new Error("invalid affine point");if(a instanceof u)throw new Error("projective point not allowed");let x=E=>e.eql(E,e.ZERO);return x(b)&&x(p)?u.ZERO:new u(b,p,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(a){let b=e.invertBatch(a.map(p=>p.pz));return a.map((p,x)=>p.toAffine(b[x])).map(u.fromAffine)}static fromHex(a){let b=u.fromAffine(s(M("pointHex",a)));return b.assertValidity(),b}static fromPrivateKey(a){return u.BASE.multiply(i(a))}static msm(a,b){return ze(u,r,a,b)}_setWindowSize(a){S.setWindowSize(this,a)}assertValidity(){l(this)}hasEvenY(){let{y:a}=this.toAffine();if(e.isOdd)return!e.isOdd(a);throw new Error("Field doesn't support isOdd")}equals(a){d(a);let{px:b,py:p,pz:x}=this,{px:E,py:_,pz:H}=a,A=e.eql(e.mul(b,H),e.mul(E,x)),L=e.eql(e.mul(p,H),e.mul(_,x));return A&&L}negate(){return new u(this.px,e.neg(this.py),this.pz)}double(){let{a,b}=n,p=e.mul(b,Yt),{px:x,py:E,pz:_}=this,H=e.ZERO,A=e.ZERO,L=e.ZERO,v=e.mul(x,x),R=e.mul(E,E),C=e.mul(_,_),q=e.mul(x,E);return q=e.add(q,q),L=e.mul(x,_),L=e.add(L,L),H=e.mul(a,L),A=e.mul(p,C),A=e.add(H,A),H=e.sub(R,A),A=e.add(R,A),A=e.mul(H,A),H=e.mul(q,H),L=e.mul(p,L),C=e.mul(a,C),q=e.sub(v,C),q=e.mul(a,q),q=e.add(q,L),L=e.add(v,v),v=e.add(L,v),v=e.add(v,C),v=e.mul(v,q),A=e.add(A,v),C=e.mul(E,_),C=e.add(C,C),v=e.mul(C,q),H=e.sub(H,v),L=e.mul(C,R),L=e.add(L,L),L=e.add(L,L),new u(H,A,L)}add(a){d(a);let{px:b,py:p,pz:x}=this,{px:E,py:_,pz:H}=a,A=e.ZERO,L=e.ZERO,v=e.ZERO,R=n.a,C=e.mul(n.b,Yt),q=e.mul(b,E),D=e.mul(p,_),w=e.mul(x,H),y=e.add(b,p),B=e.add(E,_);y=e.mul(y,B),B=e.add(q,D),y=e.sub(y,B),B=e.add(b,x);let O=e.add(E,H);return B=e.mul(B,O),O=e.add(q,w),B=e.sub(B,O),O=e.add(p,x),A=e.add(_,H),O=e.mul(O,A),A=e.add(D,w),O=e.sub(O,A),v=e.mul(R,B),A=e.mul(C,w),v=e.add(A,v),A=e.sub(D,v),v=e.add(D,v),L=e.mul(A,v),D=e.add(q,q),D=e.add(D,q),w=e.mul(R,w),B=e.mul(C,B),D=e.add(D,w),w=e.sub(q,w),w=e.mul(R,w),B=e.add(B,w),q=e.mul(D,B),L=e.add(L,q),q=e.mul(O,B),A=e.mul(y,A),A=e.sub(A,q),q=e.mul(y,D),v=e.mul(O,v),v=e.add(v,q),new u(A,L,v)}subtract(a){return this.add(a.negate())}is0(){return this.equals(u.ZERO)}wNAF(a){return S.wNAFCached(this,a,u.normalizeZ)}multiplyUnsafe(a){let{endo:b,n:p}=n;et("scalar",a,J,p);let x=u.ZERO;if(a===J)return x;if(this.is0()||a===T)return this;if(!b||S.hasPrecomputes(this))return S.wNAFCachedUnsafe(this,a,u.normalizeZ);let{k1neg:E,k1:_,k2neg:H,k2:A}=b.splitScalar(a),L=x,v=x,R=this;for(;_>J||A>J;)_&T&&(L=L.add(R)),A&T&&(v=v.add(R)),R=R.double(),_>>=T,A>>=T;return E&&(L=L.negate()),H&&(v=v.negate()),v=new u(e.mul(v.px,b.beta),v.py,v.pz),L.add(v)}multiply(a){let{endo:b,n:p}=n;et("scalar",a,T,p);let x,E;if(b){let{k1neg:_,k1:H,k2neg:A,k2:L}=b.splitScalar(a),{p:v,f:R}=this.wNAF(H),{p:C,f:q}=this.wNAF(L);v=S.constTimeNegate(_,v),C=S.constTimeNegate(A,C),C=new u(e.mul(C.px,b.beta),C.py,C.pz),x=v.add(C),E=R.add(q)}else{let{p:_,f:H}=this.wNAF(a);x=_,E=H}return u.normalizeZ([x,E])[0]}multiplyAndAddUnsafe(a,b,p){let x=u.BASE,E=(H,A)=>A===J||A===T||!H.equals(x)?H.multiplyUnsafe(A):H.multiply(A),_=E(this,b).add(E(a,p));return _.is0()?void 0:_}toAffine(a){return h(this,a)}isTorsionFree(){let{h:a,isTorsionFree:b}=n;if(a===T)return!0;if(b)return b(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:a,clearCofactor:b}=n;return a===T?this:b?b(u,this):this.multiplyUnsafe(n.h)}toRawBytes(a=!0){return Et("isCompressed",a),this.assertValidity(),o(u,this,a)}toHex(a=!0){return Et("isCompressed",a),Zt(this.toRawBytes(a))}}u.BASE=new u(n.Gx,n.Gy,e.ONE),u.ZERO=new u(e.ZERO,e.ONE,e.ZERO);let m=n.nBitLength,S=je(u,n.endo?Math.ceil(m/2):m);return{CURVE:n,ProjectivePoint:u,normPrivateKeyToScalar:i,weierstrassEquation:c,isWithinCurveOrder:f}}function Xn(t){let n=me(t);return nt(n,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(j({lowS:!0},n))}function Ke(t){let n=Xn(t),{Fp:e,n:r}=n,o=e.BYTES+1,s=2*e.BYTES+1;function c(w){return k(w,r)}function f(w){return Pt(w,r)}let{ProjectivePoint:i,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:l}=Yn(F(j({},n),{toBytes(w,y,B){let O=y.toAffine(),N=e.toBytes(O.x),Z=W;return Et("isCompressed",B),B?Z(Uint8Array.from([y.hasEvenY()?2:3]),N):Z(Uint8Array.from([4]),N,e.toBytes(O.y))},fromBytes(w){let y=w.length,B=w[0],O=w.subarray(1);if(y===o&&(B===2||B===3)){let N=K(O);if(!Bt(N,T,e.ORDER))throw new Error("Point is not on curve");let Z=h(N),G;try{G=e.sqrt(Z)}catch(X){let P=X instanceof Error?": "+X.message:"";throw new Error("Point is not on curve"+P)}let z=(G&T)===T;return(B&1)===1!==z&&(G=e.neg(G)),{x:N,y:G}}else if(y===s&&B===4){let N=e.fromBytes(O.subarray(0,e.BYTES)),Z=e.fromBytes(O.subarray(e.BYTES,2*e.BYTES));return{x:N,y:Z}}else{let N=o,Z=s;throw new Error("invalid Point, expected length of "+N+", or uncompressed "+Z+", got "+y)}}})),u=w=>Zt(tt(w,n.nByteLength));function m(w){let y=r>>T;return w>y}function S(w){return m(w)?c(-w):w}let g=(w,y,B)=>K(w.slice(y,B));class a{constructor(y,B,O){et("r",y,T,r),et("s",B,T,r),this.r=y,this.s=B,O!=null&&(this.recovery=O),Object.freeze(this)}static fromCompact(y){let B=n.nByteLength;return y=M("compactSignature",y,B*2),new a(g(y,0,B),g(y,B,2*B))}static fromDER(y){let{r:B,s:O}=rt.toSig(M("DER",y));return new a(B,O)}assertValidity(){}addRecoveryBit(y){return new a(this.r,this.s,y)}recoverPublicKey(y){let{r:B,s:O,recovery:N}=this,Z=H(M("msgHash",y));if(N==null||![0,1,2,3].includes(N))throw new Error("recovery id invalid");let G=N===2||N===3?B+n.n:B;if(G>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");let z=N&1?"03":"02",$=i.fromHex(z+u(G)),X=f(G),P=c(-Z*X),mt=c(O*X),ot=i.BASE.multiplyAndAddUnsafe($,P,mt);if(!ot)throw new Error("point at infinify");return ot.assertValidity(),ot}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new a(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return ee(this.toDERHex())}toDERHex(){return rt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ee(this.toCompactHex())}toCompactHex(){return u(this.r)+u(this.s)}}let b={isValidPrivateKey(w){try{return d(w),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{let w=le(n.n);return ke(n.randomBytes(w),n.n)},precompute(w=8,y=i.BASE){return y._setWindowSize(w),y.multiply(BigInt(3)),y}};function p(w,y=!0){return i.fromPrivateKey(w).toRawBytes(y)}function x(w){let y=kt(w),B=typeof w=="string",O=(y||B)&&w.length;return y?O===o||O===s:B?O===2*o||O===2*s:w instanceof i}function E(w,y,B=!0){if(x(w))throw new Error("first arg must be private key");if(!x(y))throw new Error("second arg must be public key");return i.fromHex(y).multiply(d(w)).toRawBytes(B)}let _=n.bits2int||function(w){if(w.length>8192)throw new Error("input is too large");let y=K(w),B=w.length*8-n.nBitLength;return B>0?y>>BigInt(B):y},H=n.bits2int_modN||function(w){return c(_(w))},A=xt(n.nBitLength);function L(w){return et("num < 2^"+n.nBitLength,w,J,A),tt(w,n.nByteLength)}function v(w,y,B=R){if(["recovered","canonical"].some(ut=>ut in B))throw new Error("sign() legacy options not supported");let{hash:O,randomBytes:N}=n,{lowS:Z,prehash:G,extraEntropy:z}=B;Z==null&&(Z=!0),w=M("msgHash",w),Ge(B),G&&(w=M("prehashed msgHash",O(w)));let $=H(w),X=d(y),P=[L(X),L($)];if(z!=null&&z!==!1){let ut=z===!0?N(e.BYTES):z;P.push(M("extraEntropy",ut))}let mt=W(...P),ot=$;function Ft(ut){let pt=_(ut);if(!l(pt))return;let te=f(pt),It=i.BASE.multiply(pt).toAffine(),ht=c(It.x);if(ht===J)return;let Ot=c(te*c(ot+ht*X));if(Ot===J)return;let wt=(It.x===ht?0:2)|Number(It.y&T),Se=Ot;return Z&&m(Ot)&&(Se=S(Ot),wt^=1),new a(ht,Se,wt)}return{seed:mt,k2sig:Ft}}let R={lowS:n.lowS,prehash:!1},C={lowS:n.lowS,prehash:!1};function q(w,y,B=R){let{seed:O,k2sig:N}=v(w,y,B),Z=n;return Le(Z.hash.outputLen,Z.nByteLength,Z.hmac)(O,N)}i.BASE._setWindowSize(8);function D(w,y,B,O=C){let N=w;y=M("msgHash",y),B=M("publicKey",B);let{lowS:Z,prehash:G,format:z}=O;if(Ge(O),"strict"in O)throw new Error("options.strict was renamed to lowS");if(z!==void 0&&z!=="compact"&&z!=="der")throw new Error("format must be compact or der");let $=typeof N=="string"||kt(N),X=!$&&!z&&typeof N=="object"&&N!==null&&typeof N.r=="bigint"&&typeof N.s=="bigint";if(!$&&!X)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let P,mt;try{if(X&&(P=new a(N.r,N.s)),$){try{z!=="compact"&&(P=a.fromDER(N))}catch(wt){if(!(wt instanceof rt.Err))throw wt}!P&&z!=="der"&&(P=a.fromCompact(N))}mt=i.fromHex(B)}catch{return!1}if(!P||Z&&P.hasHighS())return!1;G&&(y=n.hash(y));let{r:ot,s:Ft}=P,ut=H(y),pt=f(Ft),te=c(ut*pt),It=c(ot*pt),ht=i.BASE.multiplyAndAddUnsafe(mt,te,It)?.toAffine();return ht?c(ht.x)===ot:!1}return{CURVE:n,getPublicKey:p,getSharedSecret:E,sign:q,verify:D,ProjectivePoint:i,Signature:a,utils:b}}function Qn(t,n){let e=t.ORDER,r=J;for(let S=e-T;S%at===J;S/=at)r+=T;let o=r,s=at<<o-T-T,c=s*at,f=(e-T)/c,i=(f-T)/at,d=c-T,h=s,l=t.pow(n,f),u=t.pow(n,(f+T)/at),m=(S,g)=>{let a=l,b=t.pow(g,d),p=t.sqr(b);p=t.mul(p,g);let x=t.mul(S,p);x=t.pow(x,i),x=t.mul(x,b),b=t.mul(x,g),p=t.mul(x,S);let E=t.mul(p,b);x=t.pow(E,h);let _=t.eql(x,t.ONE);b=t.mul(p,u),x=t.mul(E,a),p=t.cmov(b,p,_),E=t.cmov(x,E,_);for(let H=o;H>T;H--){let A=H-at;A=at<<A-T;let L=t.pow(E,A),v=t.eql(L,t.ONE);b=t.mul(p,a),a=t.mul(a,a),L=t.mul(E,a),p=t.cmov(b,p,v),E=t.cmov(L,E,v)}return{isValid:_,value:p}};if(t.ORDER%Pe===Yt){let S=(t.ORDER-Yt)/Pe,g=t.sqrt(t.neg(n));m=(a,b)=>{let p=t.sqr(b),x=t.mul(a,b);p=t.mul(p,x);let E=t.pow(p,S);E=t.mul(E,x);let _=t.mul(E,g),H=t.mul(t.sqr(E),b),A=t.eql(H,a),L=t.cmov(_,E,A);return{isValid:A,value:L}}}return m}function We(t,n){if(Kt(t),!t.isValid(n.A)||!t.isValid(n.B)||!t.isValid(n.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let e=Qn(t,n.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let o,s,c,f,i,d,h,l;o=t.sqr(r),o=t.mul(o,n.Z),s=t.sqr(o),s=t.add(s,o),c=t.add(s,t.ONE),c=t.mul(c,n.B),f=t.cmov(n.Z,t.neg(s),!t.eql(s,t.ZERO)),f=t.mul(f,n.A),s=t.sqr(c),d=t.sqr(f),i=t.mul(d,n.A),s=t.add(s,i),s=t.mul(s,c),d=t.mul(d,f),i=t.mul(d,n.B),s=t.add(s,i),h=t.mul(o,c);let{isValid:u,value:m}=e(s,d);l=t.mul(o,r),l=t.mul(l,m),h=t.cmov(h,c,u),l=t.cmov(l,m,u);let S=t.isOdd(r)===t.isOdd(l);return l=t.cmov(t.neg(l),l,S),h=t.div(h,f),{x:h,y:l}}}function Jn(t){return{hash:t,hmac:(n,...e)=>fe(t,n,Oe(...e)),randomBytes:jt}}function Ye(t,n){let e=r=>Ke(j(j({},t),Jn(r)));return F(j({},e(n)),{create:e})}var $n=K;function dt(t,n){if(Ct(t),Ct(n),t<0||t>=1<<8*n)throw new Error("invalid I2OSP input: "+t);let e=Array.from({length:n}).fill(0);for(let r=n-1;r>=0;r--)e[r]=t&255,t>>>=8;return new Uint8Array(e)}function Fn(t,n){let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t[r]^n[r];return e}function Ct(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function tr(t,n,e,r){yt(t),yt(n),Ct(e),n.length>255&&(n=r(W(Mt("H2C-OVERSIZE-DST-"),n)));let{outputLen:o,blockLen:s}=r,c=Math.ceil(e/o);if(e>65535||c>255)throw new Error("expand_message_xmd: invalid lenInBytes");let f=W(n,dt(n.length,1)),i=dt(0,s),d=dt(e,2),h=new Array(c),l=r(W(i,t,d,dt(0,1),f));h[0]=r(W(l,dt(1,1),f));for(let m=1;m<=c;m++){let S=[Fn(l,h[m-1]),dt(m+1,1),f];h[m]=r(W(...S))}return W(...h).slice(0,e)}function er(t,n,e,r,o){if(yt(t),yt(n),Ct(e),n.length>255){let s=Math.ceil(2*r/8);n=o.create({dkLen:s}).update(Mt("H2C-OVERSIZE-DST-")).update(n).digest()}if(e>65535||n.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:e}).update(t).update(dt(e,2)).update(n).update(dt(n.length,1)).digest()}function Xe(t,n,e){nt(e,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:r,k:o,m:s,hash:c,expand:f,DST:i}=e;yt(t),Ct(n);let d=typeof i=="string"?Mt(i):i,h=r.toString(2).length,l=Math.ceil((h+o)/8),u=n*s*l,m;if(f==="xmd")m=tr(t,d,u,c);else if(f==="xof")m=er(t,d,u,o,c);else if(f==="_internal_pass")m=t;else throw new Error('expand must be "xmd" or "xof"');let S=new Array(n);for(let g=0;g<n;g++){let a=new Array(s);for(let b=0;b<s;b++){let p=l*(b+g*s),x=m.subarray(p,p+l);a[b]=k($n(x),r)}S[g]=a}return S}function Qe(t,n){let e=n.map(r=>Array.from(r).reverse());return(r,o)=>{let[s,c,f,i]=e.map(d=>d.reduce((h,l)=>t.add(t.mul(h,r),l)));if(t.is0(c)||t.is0(i))throw new Error("bad point: ZERO");return r=t.div(s,c),o=t.mul(o,t.div(f,i)),{x:r,y:o}}}function Je(t,n,e){if(typeof n!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,o){let s=Xe(r,2,j(F(j({},e),{DST:e.DST}),o)),c=t.fromAffine(n(s[0])),f=t.fromAffine(n(s[1])),i=c.add(f).clearCofactor();return i.assertValidity(),i},encodeToCurve(r,o){let s=Xe(r,1,j(F(j({},e),{DST:e.encodeDST}),o)),c=t.fromAffine(n(s[0])).clearCofactor();return c.assertValidity(),c},mapToCurve(r){if(!Array.isArray(r))throw new Error("mapToCurve: expected array of bigints");for(let s of r)if(typeof s!="bigint")throw new Error("mapToCurve: expected array of bigints");let o=t.fromAffine(n(r)).clearCofactor();return o.assertValidity(),o}}}var Rt=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Xt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Tt=BigInt(1),Qt=BigInt(2),$e=(t,n)=>(t+n/Qt)/n;function tn(t){let n=Rt,e=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),c=BigInt(23),f=BigInt(44),i=BigInt(88),d=t*t*t%n,h=d*d*t%n,l=Y(h,e,n)*h%n,u=Y(l,e,n)*h%n,m=Y(u,Qt,n)*d%n,S=Y(m,o,n)*m%n,g=Y(S,s,n)*S%n,a=Y(g,f,n)*g%n,b=Y(a,i,n)*a%n,p=Y(b,f,n)*g%n,x=Y(p,e,n)*h%n,E=Y(x,c,n)*S%n,_=Y(E,r,n)*d%n,H=Y(_,Qt,n);if(!lt.eql(lt.sqr(H),t))throw new Error("Cannot find square root");return H}var lt=Wt(Rt,void 0,void 0,{sqrt:tn}),$t=Ye({a:BigInt(0),b:BigInt(7),Fp:lt,n:Xt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let n=Xt,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Tt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,c=BigInt("0x100000000000000000000000000000000"),f=$e(s*t,n),i=$e(-r*t,n),d=k(t-f*e-i*o,n),h=k(-f*r-i*s,n),l=d>c,u=h>c;if(l&&(d=n-d),u&&(h=n-h),d>c||h>c)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:d,k2neg:u,k2:h}}}},Ht),en=BigInt(0),Fe={};function Jt(t,...n){let e=Fe[t];if(e===void 0){let r=Ht(Uint8Array.from(t,o=>o.charCodeAt(0)));e=W(r,r),Fe[t]=e}return Ht(W(e,...n))}var Be=t=>t.toRawBytes(!0).slice(1),ye=t=>tt(t,32),we=t=>k(t,Rt),Ut=t=>k(t,Xt),ve=$t.ProjectivePoint,nr=(t,n,e)=>ve.BASE.multiplyAndAddUnsafe(t,n,e);function Ee(t){let n=$t.utils.normPrivateKeyToScalar(t),e=ve.fromPrivateKey(n);return{scalar:e.hasEvenY()?n:Ut(-n),bytes:Be(e)}}function nn(t){et("x",t,Tt,Rt);let n=we(t*t),e=we(n*t+BigInt(7)),r=tn(e);r%Qt!==en&&(r=we(-r));let o=new ve(t,r,Tt);return o.assertValidity(),o}var _t=K;function rn(...t){return Ut(_t(Jt("BIP0340/challenge",...t)))}function rr(t){return Ee(t).bytes}function or(t,n,e=jt(32)){let r=M("message",t),{bytes:o,scalar:s}=Ee(n),c=M("auxRand",e,32),f=ye(s^_t(Jt("BIP0340/aux",c))),i=Jt("BIP0340/nonce",f,o,r),d=Ut(_t(i));if(d===en)throw new Error("sign failed: k is zero");let{bytes:h,scalar:l}=Ee(d),u=rn(h,o,r),m=new Uint8Array(64);if(m.set(h,0),m.set(ye(Ut(l+u*s)),32),!on(m,r,o))throw new Error("sign: Invalid signature produced");return m}function on(t,n,e){let r=M("signature",t,64),o=M("message",n),s=M("publicKey",e,32);try{let c=nn(_t(s)),f=_t(r.subarray(0,32));if(!Bt(f,Tt,Rt))return!1;let i=_t(r.subarray(32,64));if(!Bt(i,Tt,Xt))return!1;let d=rn(ye(f),Be(c),o),h=nr(c,i,Ut(-d));return!(!h||!h.hasEvenY()||h.toAffine().x!==f)}catch{return!1}}var lo={getPublicKey:rr,sign:or,verify:on,utils:{randomPrivateKey:$t.utils.randomPrivateKey,lift_x:nn,pointToBytes:Be,numberToBytesBE:tt,bytesToNumberBE:K,taggedHash:Jt,mod:k}},sr=Qe(lt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(n=>BigInt(n)))),ir=We(lt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:lt.create(BigInt("-11"))}),sn=Je($t.ProjectivePoint,t=>{let{x:n,y:e}=ir(lt.create(t[0]));return sr(n,e)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:lt.ORDER,m:1,k:128,expand:"xmd",hash:Ht}),uo=sn.hashToCurve,ho=sn.encodeToCurve;export{jt as a,Un as b,k as c,Y as d,kr as e,Wt as f,je as g,ze as h,me as i,$t as j,lo as k,uo as l,ho as m};
